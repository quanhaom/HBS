package frame;

import java.awt.GridLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.JPasswordField;
import javax.swing.JTextField;
import model.Person;
import services.Store;

public class SignInFrame extends JFrame {
    private JTextField userIdField;
    private JTextField nameField;
    private JPasswordField passwordField;
    private Store store; // Reference to the Store class

    public SignInFrame(Store store) {
        this.store = store;

        setTitle("Sign Up");
        setSize(300, 200);
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        setLocationRelativeTo(null); // Center the frame

        // Create UI components
        JLabel userIdLabel = new JLabel("User ID:");
        userIdField = new JTextField(15);
        JLabel nameLabel = new JLabel("Name:");
        nameField = new JTextField(15);
        JLabel passwordLabel = new JLabel("Password:");
        passwordField = new JPasswordField(15);
        JButton signUpButton = new JButton("Sign Up");

        // Set up layout
        setLayout(new GridLayout(4, 2));
        add(userIdLabel);
        add(userIdField);
        add(nameLabel);
        add(nameField);
        add(passwordLabel);
        add(passwordField);
        add(signUpButton);

        // Action listener for sign-up button
        signUpButton.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent e) {
                registerUser();
            }
        });
    }

    private void registerUser() {
        String userId = userIdField.getText();
        String name = nameField.getText();
        String password = new String(passwordField.getPassword());

        // Validate input
        if (userId.isEmpty() || name.isEmpty() || password.isEmpty()) {
            JOptionPane.showMessageDialog(this, "All fields are required!");
            return;
        }

        // Add user to the store
        Person newUser = new Person(userId, name, password, "Customer"); // Default role as Customer
        store.addUser(newUser);
        JOptionPane.showMessageDialog(this, "Registration successful!");

        dispose(); // Close SignInFrame
        new LoginFrame(store).setVisible(true); // Return to login
    }
}
